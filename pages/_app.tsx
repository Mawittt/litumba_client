import '../styles/globals.css'
import "../styles/Footer.scss"
import type { AppProps } from 'next/app'
import { store, wrapper } from '../store/store'
import { Provider } from 'react-redux'
import Head from 'next/head'
import LeftSideBar from '../components/LeftSideBar/LeftSideBar'
import TopNavBar from '../components/TopNavBar/TopNavBar'
import { NotifierAlertIcon, NotifierConfirmIcon, NotifierWarningIcon, RightIcon } from '../assets/icons'
import RightNavBar from '../components/RightNavBar/RightNavBar'
import FooterNav from '../components/FooterNav/FooterNav'
import { ReactElement, ReactNode, useEffect, useState } from 'react'
import { NextPage } from 'next'
import useApp from '../pageUtils/useApp'
import { QueryClientProvider, QueryClient } from 'react-query'
import AppSetup from '../components/AppSetup/AppSetup'
import { SessionProvider } from "next-auth/react"
import Script from 'next/script'
import Loader from '../assets/Loader'


export type NextPageWithLayout<P = {}, IP = P> = NextPage<P, IP> & {
    getLayout?: (page: ReactElement) => ReactNode
}

type AppPropsWithLayout = AppProps & {
    Component: NextPageWithLayout
}

const client = new QueryClient()

function App({ Component, pageProps: { session, ...pageProps } }: AppPropsWithLayout) {
    const { } = useApp()

    return (
        <Provider store={store}>
            <QueryClientProvider client={client} >
                <Head>
                    <title>Litumba - The Bakwerian online platform</title>
                    <meta name="description" content="Generated by create next app" />
                </Head>
                <AppSetup />
                {Component.getLayout ? <SessionProvider session={session} >
                    <Head>
                        <script src="https://accounts.google.com/gsi/client" async={true} defer={true}></script>
                    </Head>
                    <Component {...pageProps} />
                </SessionProvider> :
                    <>
                        <div id='app' className="bg-blue-50 flex flex-col h-full overflow-hidden">
                            <div className='h-[50px] relative overflow-hidden shadow-comp_lg flex items-center justify-center bg-white'><TopNavBar /></div>
                            <div className='flex justify-between max-w-[1148px] m-auto w-full h-1 grow '>
                                <div className=' hidden min-[994px]:block h-full md:overflow-auto py-6 min-w-[260px]'><LeftSideBar /></div>
                                <div className=' h-full overflow-x-hidden overflow-y-auto grow' id='page-component'><Component {...pageProps} /></div>
                                <div id="app_menu" className='hidden top-0 left-0 z-10 h-screen overflow-scroll w-full max-[640px]:max-w-fit max-[640px]:bg-white sm:relative sm:block sm:h-full sm:overflow-scroll max-w-[350px] px-4 '><RightNavBar /></div>
                            </div>
                            <div className=' sm:col-span-2 min-[994px]:hidden w-full self-end'><FooterNav /></div>
                        </div>
                    </>}
                <div className='fixed top-[0]  left-0 w-full  flex justify-center z-20'>
                    <div id='notifier-confirmation' className='max-w-sm absolute ring translate-y-[-120%]  px-6 py-4 flex items-center rounded-lg bg-[#ffffff00] backdrop-blur-[4px] ring ring-green-600 text-green-600 shadow-comp_lg'>
                        <NotifierConfirmIcon />
                        <span className='ml-4 '>confirmation message</span>
                    </div>
                    <div id='notifier-warning' className='max-w-sm max-sm:max-w-[90vw] absolute ring px-6 translate-y-[-120%] py-4 flex items-center rounded-lg bg-[#ffffff00] backdrop-blur-[4px] ring ring-red-400 text-red-400 shadow-comp_lg'>
                        <NotifierWarningIcon />
                        <span className='ml-4 '>warning message</span>
                    </div>
                    <div id='notifier-alert' className='max-w-sm absolute ring px-6 translate-y-[-120%] py-4 flex items-center rounded-lg bg-[#ffffff00] backdrop-blur-[4px] ring ring-yellow-500 text-yellow-700 font-semibold shadow-comp_lg'>
                        <NotifierAlertIcon />
                        <span className='ml-4 '>confirmation message</span>
                    </div>
                </div>
            </QueryClientProvider>
        </Provider>
    )
}

export default App



